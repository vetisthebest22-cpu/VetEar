<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VetPulse - AI Veterinary Sound Analysis</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/audio@0.8/dist/teachablemachine-audio.min.js"></script>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Inter',sans-serif; background:#fff; min-height:100vh; position:relative; overflow-x:hidden; }
.header{ background:rgba(255,255,255,0.95); backdrop-filter:blur(10px); padding:1rem 2rem; box-shadow:0 4px 20px rgba(124,58,237,0.1); position:relative; z-index:10; }
.nav-container{ max-width:1200px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; }
.logo{ display:flex; align-items:center; gap:12px; font-size:1.5rem; font-weight:700; color:#7C3AED; }
.mic-button{ width:80px; height:80px; border-radius:50%; background:linear-gradient(135deg,#7C3AED,#10B981); border:none; cursor:pointer; display:flex; align-items:center; justify-content:center; margin:0 auto; box-shadow:0 8px 25px rgba(124,58,237,0.3); transition:all 0.3s; animation:pulse 2s ease-in-out infinite; }
.mic-button:hover{ transform:scale(1.1); box-shadow:0 12px 35px rgba(124,58,237,0.4); }
@keyframes pulse{0%,100%{box-shadow:0 8px 25px rgba(124,58,237,0.3),0 0 0 0 rgba(124,58,237,0.4);}50%{box-shadow:0 8px 25px rgba(124,58,237,0.3),0 0 0 20px rgba(124,58,237,0);} }
.main-container{ max-width:1200px; margin:0 auto; padding:3rem 2rem; position:relative; z-index:5; }
.hero-title{ font-size:3rem; font-weight:700; color:#7C3AED; margin-bottom:1rem; text-align:center;}
.hero-subtitle{ font-size:1.2rem; color:#6B7280; margin-bottom:2rem; text-align:center;}
.microphone-container{ margin:2rem 0; text-align:center; }
#countdown { margin-top:10px; font-weight:600; color:#7C3AED; }
.analysis-grid{ display:grid; grid-template-columns:1fr 1fr; gap:3rem; margin-top:3rem; }
.progress-item{ background:rgba(255,255,255,0.9); padding:1.5rem; border-radius:20px; box-shadow:0 8px 25px rgba(0,0,0,0.1); display:flex; align-items:center; gap:1.5rem; transition:all 0.3s; }
.radial-progress{ position:relative; width:80px; height:80px; }
.progress-circle{ width:80px; height:80px; border-radius:50%; background:conic-gradient(#10B981 0deg,#E5E7EB 0deg); display:flex; align-items:center; justify-content:center; position:relative; }
.progress-circle::before{ content:''; position:absolute; width:60px; height:60px; background:white; border-radius:50%; }
.progress-text{ position:absolute; font-weight:700; color:#7C3AED; z-index:1; }
.progress-info h3{ font-size:1.1rem; font-weight:600; color:#374151; margin-bottom:0.5rem; }
.progress-info p{ color:#6B7280; font-size:0.9rem; }
@media(max-width:768px){.analysis-grid{grid-template-columns:1fr; gap:2rem;} .hero-title{font-size:2rem;} }
#ai-popup{ position:fixed; right:20px; top:20px; background:white; border:2px solid #7C3AED; padding:15px; border-radius:12px; box-shadow:0 8px 20px rgba(124,58,237,0.3); display:none; z-index:50; }
</style>
</head>
<body>

<header class="header">
    <nav class="nav-container">
        <div class="logo">VetPulse</div>
    </nav>
</header>

<main class="main-container">
    <h1 class="hero-title">VetPulse AI Analysis</h1>
    <p class="hero-subtitle">Advanced veterinary sound analysis powered by AI</p>
    <div class="microphone-container">
        <button class="mic-button" onclick="toggleListening()" aria-label="Start audio analysis">
            🎤
        </button>
        <div id="countdown"></div>
    </div>

    <div class="analysis-grid">
        <div class="progress-item">
            <div class="radial-progress"><div class="progress-circle" id="noise-progress"><span class="progress-text" id="noise-text">0%</span></div></div>
            <div class="progress-info"><h3>Background Noise</h3><p>Environmental sounds detected</p></div>
        </div>
        <div class="progress-item">
            <div class="radial-progress"><div class="progress-circle" id="human-progress"><span class="progress-text" id="human-text">0%</span></div></div>
            <div class="progress-info"><h3>Human - Normal</h3><p>Human respiratory sounds</p></div>
        </div>
        <div class="progress-item">
            <div class="radial-progress"><div class="progress-circle" id="animal-progress"><span class="progress-text" id="animal-text">0%</span></div></div>
            <div class="progress-info"><h3>Small Animal - Normal</h3><p>Healthy animal breathing patterns</p></div>
        </div>
        <div class="progress-item">
            <div class="radial-progress"><div class="progress-circle" id="wheeze-progress"><span class="progress-text" id="wheeze-text">0%</span></div></div>
            <div class="progress-info"><h3>Wheezing</h3><p>Respiratory distress indicators</p></div>
        </div>
    </div>
</main>

<div id="ai-popup"><strong>AI Analysis Result:</strong><p id="popup-text">Analyzing...</p></div>

<script>
let model, maxPredictions, isListening=false, countdownInterval;

async function initAI() {
    const URL = "رابط_الموديل_هنا/"; // حط رابط الموديل
    model = await tmAudio.load(URL + "model.json", URL + "metadata.json");
    maxPredictions = model.getTotalClasses();
}
initAI();

function updateProgress(elementId,textId,percentage){
    const circle=document.getElementById(elementId);
    const text=document.getElementById(textId);
    const degrees=(percentage/100)*360;
    circle.style.background=`conic-gradient(#10B981 ${degrees}deg,#E5E7EB ${degrees}deg)`;
    text.textContent=`${percentage}%`;
}

async function startListening(){
    await model.start();
    let remaining=10;
    const countdownEl=document.getElementById('countdown');
    countdownEl.textContent=`Analyzing... ${remaining}s`;
    countdownInterval=setInterval(()=>{
        remaining--;
        countdownEl.textContent=`Analyzing... ${remaining}s`;
        if(remaining<=0){
            clearInterval(countdownInterval);
            countdownEl.textContent=`Analysis Complete`;
            stopListening();
        }
    },1000);
}

async function stopListening(){
    await model.stop();
    simulateAnalysis();
}

function toggleListening(){
    isListening = !isListening;
    if(isListening){
        startListening();
    } else {
        clearInterval(countdownInterval);
        stopListening();
        document.getElementById('countdown').textContent='';
    }
}

function simulateAnalysis(){
    const scenarios=[
        {noise:12,human:18,animal:92,wheeze:3,recommendation:"Excellent! Very healthy small animal."},
        {noise:25,human:45,animal:35,wheeze:15,recommendation:"Mixed signals detected. Reduce background noise."},
        {noise:8,human:12,animal:25,wheeze:78,recommendation:"⚠️ Significant wheezing! Immediate attention."}
    ];
    const scenario=scenarios[Math.floor(Math.random()*scenarios.length)];

    ['noise','human','animal','wheeze'].forEach(key=>{
        const target=scenario[key];
        const steps=20;
        let current=0;
        const textId=key+'-text';
        const circleId=key+'-progress';
        const increment=target/steps;
        const interval=setInterval(()=>{
            current+=increment;
            if(current>=target){ current=target; clearInterval(interval); }
            updateProgress(circleId,textId,Math.round(current));
        },100);
    });

    const popup=document.getElementById('ai-popup');
    const popupText=document.getElementById('popup-text');
    popup.style.display='block';
    popupText.textContent='Analyzing...';
    setTimeout(()=>{ popupText.textContent=scenario.recommendation; },2500);
}
</script>
</body>
</html>
