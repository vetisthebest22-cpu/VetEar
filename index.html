<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VetPulse - AI Veterinary Sound Analysis</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
    * {margin:0; padding:0; box-sizing:border-box;}
    body {font-family:'Inter', sans-serif; background:#fefefe; min-height:100vh; overflow-x:hidden; position:relative;}

    .header {background: rgba(255,255,255,0.95); padding:1rem 2rem; box-shadow:0 4px 20px rgba(124,58,237,0.1);}
    .nav-container {display:flex; justify-content:space-between; align-items:center; max-width:1200px; margin:0 auto;}
    .logo {font-size:1.5rem; font-weight:700; color:#7C3AED;}

    .main-container {max-width:1200px; margin:0 auto; padding:3rem 2rem; position:relative; z-index:5; text-align:center;}
    .hero-title {font-size:3rem; font-weight:700; color:#7C3AED; margin-bottom:1rem;}
    .hero-subtitle {font-size:1.2rem; color:#6B7280; margin-bottom:2rem;}
    .mic-button {width:80px; height:80px; border-radius:50%; background:linear-gradient(135deg,#7C3AED,#10B981); border:none; cursor:pointer; display:flex; align-items:center; justify-content:center; margin:0 auto; box-shadow:0 8px 25px rgba(124,58,237,0.3); animation:pulse 2s ease-in-out infinite; transition:all 0.3s ease;}
    .mic-button:hover {transform:scale(1.1); box-shadow:0 12px 35px rgba(124,58,237,0.4);}
    @keyframes pulse {0%,100%{box-shadow:0 8px 25px rgba(124,58,237,0.3),0 0 0 0 rgba(124,58,237,0.4);}50%{box-shadow:0 8px 25px rgba(124,58,237,0.3),0 0 0 20px rgba(124,58,237,0);}}

    .analysis-grid {display:grid; grid-template-columns:1fr 1fr; gap:3rem; margin-top:3rem;}
    .progress-item {background: rgba(255,255,255,0.9); padding:1.5rem; border-radius:20px; display:flex; align-items:center; gap:1.5rem; box-shadow:0 8px 25px rgba(0,0,0,0.1);}
    .radial-progress {position:relative; width:80px; height:80px;}
    .progress-circle {width:80px; height:80px; border-radius:50%; background: conic-gradient(#10B981 0deg, #E5E7EB 0deg); display:flex; align-items:center; justify-content:center; position:relative; animation:breathe 3s ease-in-out infinite;}
    @keyframes breathe {0%,100%{transform:scale(1);}50%{transform:scale(1.05);}}
    .progress-circle::before {content:''; position:absolute; width:60px; height:60px; background:white; border-radius:50%;}
    .progress-text {position:absolute; font-weight:700; color:#7C3AED; z-index:1;}
    .progress-info h3 {font-size:1.1rem; font-weight:600; color:#374151; margin-bottom:0.5rem;}
    .progress-info p {color:#6B7280; font-size:0.9rem;}

    /* Sound popup */
    .sound-popup {position:fixed; top:20px; left:50%; transform:translateX(-50%); background:linear-gradient(135deg,#7C3AED,#10B981); color:white; padding:1rem 2rem; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,0.2); display:flex; align-items:center; gap:1rem; font-weight:600; z-index:100; animation:popupFade 0.5s ease forwards;}
    .sound-popup .close-btn {cursor:pointer; font-weight:bold; font-size:1.2rem;}
    @keyframes popupFade {0%{opacity:0; transform:translateX(-50%) translateY(-20px);} 100%{opacity:1; transform:translateX(-50%) translateY(0);} }

    @media(max-width:768px){.analysis-grid{grid-template-columns:1fr;}}
</style>
</head>
<body>

<header class="header">
    <nav class="nav-container">
        <div class="logo">VetPulse</div>
    </nav>
</header>

<main class="main-container">
    <h1 class="hero-title">VetPulse AI Analysis</h1>
    <p class="hero-subtitle">Advanced veterinary sound analysis powered by AI</p>

    <button class="mic-button" onclick="toggleListening()" aria-label="Start audio analysis">
        ðŸŽ¤
    </button>

    <div class="analysis-grid">
        <div class="progress-item">
            <div class="radial-progress">
                <div class="progress-circle" id="noise-progress"><span class="progress-text" id="noise-text">0%</span></div>
            </div>
            <div class="progress-info"><h3>Background Noise</h3><p>Environmental sounds detected</p></div>
        </div>
        <div class="progress-item">
            <div class="radial-progress">
                <div class="progress-circle" id="animal-progress"><span class="progress-text" id="animal-text">0%</span></div>
            </div>
            <div class="progress-info"><h3>Small Animal</h3><p>Healthy animal breathing patterns</p></div>
        </div>
        <div class="progress-item">
            <div class="radial-progress">
                <div class="progress-circle" id="wheeze-progress"><span class="progress-text" id="wheeze-text">0%</span></div>
            </div>
            <div class="progress-info"><h3>Wheezing</h3><p>Respiratory distress indicators</p></div>
        </div>
    </div>
</main>

<script>
let audioContext, analyser, dataArray;
let isListening = false;

async function startMicrophone() {
    audioContext = new (window.AudioContext || window.webkitAudioContext)();
    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    const source = audioContext.createMediaStreamSource(stream);
    analyser = audioContext.createAnalyser();
    source.connect(analyser);
    analyser.fftSize = 256;
    dataArray = new Uint8Array(analyser.frequencyBinCount);
    updateProgress();
}

function toggleListening() {
    if(!isListening) { startMicrophone(); isListening = true; }
}

function updateProgress() {
    analyser.getByteFrequencyData(dataArray);
    let sum=0;
    for(let i=0;i<dataArray.length;i++){sum+=dataArray[i];}
    let avg = sum/dataArray.length;
    let percent = Math.min(100, Math.round((avg/255)*100));

    document.getElementById("noise-text").innerText = percent + "%";
    document.getElementById("noise-progress").style.background = `conic-gradient(#10B981 ${percent*3.6}deg,#E5E7EB 0deg)`;

    // Ù…Ø«Ø§Ù„ ØªØ¨Ø³ÙŠØ·: Ù†ÙØ³ Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„Ù„Ø«Ù„Ø§Ø« Ù…Ø¤Ø´Ø±Ø§Øª
    document.getElementById("animal-text").innerText = percent + "%";
    document.getElementById("animal-progress").style.background = `conic-gradient(#10B981 ${percent*3.6}deg,#E5E7EB 0deg)`;
    document.getElementById("wheeze-text").innerText = percent + "%";
    document.getElementById("wheeze-progress").style.background = `conic-gradient(#10B981 ${percent*3.6}deg,#E5E7EB 0deg)`;

    // Ø¥Ø¸Ù‡Ø§Ø± popup
    showSoundPopup(avg, percent);

    requestAnimationFrame(updateProgress);
}

function showSoundPopup(avg, percent) {
    if(document.querySelector('.sound-popup')) return; // Ø¥Ø°Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ù„Ø§ ØªØ¶ÙŠÙ
    const popup = document.createElement('div');
    popup.className = 'sound-popup';
    popup.innerHTML = `The sound is ${Math.round(avg)} <span>With Percentage ${percent}%</span><span class="close-btn" onclick="this.parentElement.remove()">âœ–</span>`;
    document.body.appendChild(popup);

    // ÙŠØ®ØªÙÙŠ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠ
    setTimeout(()=>{ if(popup) popup.remove(); },3000);
}
</script>

</body>
</html>
