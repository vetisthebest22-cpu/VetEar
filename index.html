<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VetPulse - AI Veterinary Sound Analysis</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
/* ŸÉŸÑ CSS ÿßŸÑŸÖŸàÿ¨ŸàÿØ ŸÖŸÜ ÿßŸÑÿ™ÿµŸÖŸäŸÖ ÿßŸÑÿ≥ÿßÿ®ŸÇ (ÿßÿ≠ÿ™ŸÅÿ∏ŸÜÿß ÿ®ŸÉŸÑ ÿ¥Ÿäÿ°) */
body { font-family: 'Inter', sans-serif; background:#fff; min-height:100vh; position:relative; overflow-x:hidden; }
.header { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding:1rem 2rem; box-shadow: 0 4px 20px rgba(124,58,237,0.1); position:relative; z-index:10; }
.main-container { max-width:1200px; margin:0 auto; padding:3rem 2rem; position:relative; z-index:5; }
.mic-button { width:80px; height:80px; border-radius:50%; background: linear-gradient(135deg,#7C3AED,#10B981); border:none; cursor:pointer; display:flex; align-items:center; justify-content:center; margin:0 auto; box-shadow:0 8px 25px rgba(124,58,237,0.3); animation: pulse 2s ease-in-out infinite; }
@keyframes pulse { 0%,100% { box-shadow:0 8px 25px rgba(124,58,237,0.3),0 0 0 0 rgba(124,58,237,0.4);} 50% { box-shadow:0 8px 25px rgba(124,58,237,0.3),0 0 0 20px rgba(124,58,237,0);} }
.progress-circle { width:80px; height:80px; border-radius:50%; background: conic-gradient(#10B981 0deg,#E5E7EB 0deg); display:flex; align-items:center; justify-content:center; position:relative; }
.progress-circle::before { content:''; position:absolute; width:60px; height:60px; background:white; border-radius:50%; }
.progress-text { position:absolute; font-weight:700; color:#7C3AED; z-index:1; }
#sound-result { position:fixed; top:20px; left:50%; transform:translateX(-50%); background: rgba(124,58,237,0.9); color:white; padding:12px 20px; border-radius:12px; font-weight:600; display:none; z-index:50; }
</style>
</head>
<body>

<div id="sound-result"></div>

<header class="header">
  <div class="logo">VetPulse</div>
</header>

<main class="main-container">
  <section class="hero-section" style="text-align:center;">
    <button class="mic-button" onclick="toggleListening()" aria-label="Start audio analysis">
      üé§
    </button>
  </section>

  <div class="analysis-grid" style="display:grid;grid-template-columns:repeat(2,1fr);gap:2rem;margin-top:3rem;">
    <div class="progress-item">
      <div class="radial-progress">
        <div class="progress-circle" id="noise-progress"><span class="progress-text" id="noise-text">0%</span></div>
      </div>
      <div class="progress-info"><h3>Background Noise</h3></div>
    </div>
    <div class="progress-item">
      <div class="radial-progress">
        <div class="progress-circle" id="human-progress"><span class="progress-text" id="human-text">0%</span></div>
      </div>
      <div class="progress-info"><h3>Human - Normal</h3></div>
    </div>
    <div class="progress-item">
      <div class="radial-progress">
        <div class="progress-circle" id="animal-progress"><span class="progress-text" id="animal-text">0%</span></div>
      </div>
      <div class="progress-info"><h3>Small Animal - Normal</h3></div>
    </div>
    <div class="progress-item">
      <div class="radial-progress">
        <div class="progress-circle" id="wheeze-progress"><span class="progress-text" id="wheeze-text">0%</span></div>
      </div>
      <div class="progress-info"><h3>Wheezing</h3></div>
    </div>
  </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/speech-commands@0.4.0/dist/speech-commands.min.js"></script>
<script>
const URL = "./my_model/";
let recognizer;
let isListening = false;

async function createModel(){
    const checkpointURL = URL + "model.json";
    const metadataURL = URL + "metadata.json";
    recognizer = speechCommands.create("BROWSER_FFT", undefined, checkpointURL, metadataURL);
    await recognizer.ensureModelLoaded();
    console.log("Model loaded");
}

async function toggleListening(){
    const button = document.querySelector('.mic-button');
    if(!recognizer) await createModel();

    isListening = !isListening;
    if(isListening){
        button.style.background='linear-gradient(135deg,#10B981,#7C3AED)';
        recognizer.listen(result=>{
            const scores = result.scores.map(s=>Math.round(s*100));
            const labels = recognizer.wordLabels();
            updateProgress('noise-progress','noise-text',scores[labels.indexOf('Background Noise')]);
            updateProgress('human-progress','human-text',scores[labels.indexOf('Human - Normal')]);
            updateProgress('animal-progress','animal-text',scores[labels.indexOf('Small Animal - Normal')]);
            updateProgress('wheeze-progress','wheeze-text',scores[labels.indexOf('Wheezing')]);

            const maxIndex = scores.indexOf(Math.max(...scores));
            document.getElementById('sound-result').textContent = `The sound is "${labels[maxIndex]}" with ${scores[maxIndex]}%`;
            document.getElementById('sound-result').style.display='block';
        },{
            includeSpectrogram:true,
            probabilityThreshold:0,
            invokeCallbackOnNoiseAndUnknown:true,
            overlapFactor:0.5
        });
    }else{
        recognizer.stopListening();
        button.style.background='linear-gradient(135deg,#7C3AED,#10B981)';
        document.getElementById('sound-result').style.display='none';
    }
}

function updateProgress(circleId,textId,percentage){
    const circle = document.getElementById(circleId);
    const text = document.getElementById(textId);
    const deg = (percentage/100)*360;
    circle.style.background=`conic-gradient(#10B981 ${deg}deg, #E5E7EB ${deg}deg)`;
    text.textContent = percentage+'%';
}
</script>

</body>
</html>

